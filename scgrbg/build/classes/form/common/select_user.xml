<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE Forms SYSTEM "../form_definition.dtd"><Forms>	<form id="select_user" desp="选择人员" implement="loginvalidate_interface">		<import language="css" file="pt/res/css/newcss.css"></import>		<widgets>			<basic name="flag" widget="Hidden" default="2"/>			 <!-- isnull是否可以不选择人员保存，默认false -->			<basic name="isnull" widget="Hidden" default="false"/>			<basic name="initselecteduser" widget="Hidden"/>			<layout type="BandLayout" width="700px" attr="cellspacing:0;cellpadding:0;align:center">				<layout type="BandLayout" name="titleLayout" width="98%"					 attr="groupSize:2;" topSpace="5px">					<basic name="tp" widget="Label" width="15px" height="20px"						backgroundImg="pt/img/imgs.png" />					<basic name="ddddd" label="选择人员" widget="Label" attr="width:300px"						leftSpace="10px" align="left" />				</layout>				<layout name="position" type="VerticalLayout" topSpace="10px">					<layout name="tree" type="BandLayout"						attr="groupSize:1;valign:top;">						<basic name="tree1" widget="XTree" attr="foldclick:true;" height="480px;" width="180px;">							<valueFetcher								type="com.aisino.platform.view.basicWidget.fetcher.XTreeFetcher">								<value name="object">cn.com.huadi.aos.hdoa.unit.plugin.UnitTreePlugin</value>							</valueFetcher>						</basic>					</layout>					<layout desp="待选人员" name="noselect" type="BandLayout"						attr="groupSize:1;valign:top;" leftSpace="10px">						<basic name="leftBox" widget="ListBox" height="480px"							width="150px">						</basic>					</layout>					<layout name="button" type="BandLayout"						attr="groupSize:1;align:center;" width="100px" topSpace="100px">						<basic name="add" label="添加" class="gradual-btnitem" width="80px"							height="25px" topSpace="10px" widget="OButton" />						<basic name="addall" label="全部添加" class="gradual-btnitem"							width="80px" height="25px" topSpace="10px" widget="OButton" />						<basic name="remove" label="删除" class="gradual-btnitem"							width="80px" height="25px" topSpace="10px" widget="OButton" />						<basic name="removeall" label="全部删除" class="gradual-btnitem"							width="80px" height="25px" topSpace="10px" widget="OButton" />					</layout>					<layout desp="已选人员" name="selected" type="BandLayout"						attr="groupSize:1;valign:top;">						<basic name="rightBox" widget="ListBox"							height="480px" width="150px">						</basic>					</layout>				</layout>				<layout name="query" type="BandLayout" topSpace="10px"				 attr="cellspacing:0;cellpadding:0;align:center">					<basic name="ok" label="确定" class="gradual-btnitem" width="60px"						height="25px" leftSpace="10px" widget="OButton" />					<basic name="closeit" label="关闭" class="gradual-btnitem" width="60px"						height="25px" leftSpace="10px" widget="OButton" />				</layout>			</layout>		</widgets>		<extendPoint>			<plugin type="cn.com.huadi.aos.hdoa.unit.plugin.UnitPlugin"				submitEvent="loaduser"></plugin>		</extendPoint>		<bind element="this" event="onCreate"><![CDATA[			var flag=wg('flag');			if(flag==1){				w('addall').hiding();				w('removeall').hiding();			}		]]></bind>		<bind element="tree1" event="doclick" param="id,data,level,isLeaf,parentId"><![CDATA[			/*右边已选人员不在待选显示*/				var ids =w('rightBox').getAllItem();				PT.s('loaduser','','deptid='+id+'&selecteduser='+ids);			]]>		</bind>		<bind element="add" event="click"><![CDATA[				var id=w('leftBox').get();				var name=w('leftBox').getText();				if(id!=null&&name!=null){				/*判断是否重复选择*/					var list=w('rightBox').getAllItem();					var left=w('leftBox');					if(list!=null){						/*如果当前为单选，第二次选择人员时做验证并提示*/						var flag=wg('flag');						if(flag==1){							PT.alert('只能选择一个人员');							return;						}						var flag=true;						for(var i=0;i<list.length;i++){							if(list[i]==id){								PT.alert('人员重复');								flag=false;								break;							}else{								continue;							}						}						if(flag){						/*选择人员从左边待选人员列表中移除*/							left.removeSelect();							w('rightBox').add(id,name,name);						}						}else{					/*选择人员从左边待选人员列表中移除*/						left.removeSelect();						w('rightBox').add(id,name,name);					}				}else{					PT.alert('请选择人员');				}			]]>		</bind>		<bind element="leftBox" event="dblclick"><![CDATA[				var id=w('leftBox').get();				var name=w('leftBox').getText();				if(id!=null&&name!=null){				/*判断是否重复选择*/					var list=w('rightBox').getAllItem();					var left=w('leftBox');					if(list!=null){						/*如果当前为单选，第二次选择人员时做验证并提示*/						var flag=wg('flag');						if(flag==1){							PT.alert('只能选择一个人员');							return;						}						var flag=true;						for(var i=0;i<list.length;i++){							if(list[i]==id){								PT.alert('人员重复');								flag=false;								break;							}else{								continue;							}						}						if(flag){						/*选择人员从左边待选人员列表中移除*/							left.removeSelect();							w('rightBox').add(id,name,name);						}						}else{					/*选择人员从左边待选人员列表中移除*/						left.removeSelect();						w('rightBox').add(id,name,name);					}				}else{					PT.alert('请选择人员');				}			]]>		</bind>		<bind element="addall" event="click"><![CDATA[				var ids=w('leftBox').getAllItem();				var names=w('leftBox').getAllText();			/*判断是否重复选择*/				var list=w('rightBox').getAllItem();				if(ids!=null&&names!=null){					for(var i=0;i<ids.length;i++){						if(list!=null){							var flag=true;							for(var j=0;j<list.length;j++){								if(list[j]==ids[i]){									flag=false;									break;								}else{									continue;								}							}							if(flag){								w('rightBox').add(ids[i],names[i],names[i]);							}						}else{							w('rightBox').add(ids[i],names[i],names[i]);						}					}				}else{					PT.alert('没有可添加人员');				}			/*左边全部移除*/				w('leftBox').removeAll();			]]></bind>		<bind element="remove" event="click"><![CDATA[			/*从已选删除后应该放回待选*/				var id=w('rightBox').get();				var name=w('rightBox').getText();				if(id&&name)					w('leftBox').add(id,name,name);				else					PT.alert('请选择要移除的人员');			/*右边移除*/				w('rightBox').removeSelect();		]]></bind>		<bind element="rightBox" event="dblclick"><![CDATA[			/*从已选删除后应该放回待选*/				var id=w('rightBox').get();				var name=w('rightBox').getText();				if(id&&name)					w('leftBox').add(id,name,name);				else					PT.alert('请选择要移除的人员');			/*右边移除*/				w('rightBox').removeSelect();		]]></bind>		<bind element="removeall" event="click"><![CDATA[				var ids=w('rightBox').getAllItem();				var names=w('rightBox').getAllText();			/*判断是否重复选择*/				var list=w('leftBox').getAllItem();				if(ids!=null&&names!=null){					for(var i=0;i<ids.length;i++){						if(list!=null){							var flag=true;							for(var j=0;j<list.length;j++){								if(list[j]==ids[i]){									flag=false;									break;								}else{									continue;								}							}							if(flag){								w('leftBox').add(ids[i],names[i],names[i]);							}						}else{							w('leftBox').add(ids[i],names[i],names[i]);						}					}				}else{					PT.alert('没有要移除的人员');				}			/*右边全部移除*/				w('rightBox').removeAll();			]]>		</bind>		<bind element="ok" event="click"> <![CDATA[				var ids =w('rightBox').getAllItem();				var names =w('rightBox').getAllText();				var isnull=wg('isnull');/*是否可以不选择人员保存*/				var users="";				if(ids==null&&isnull=='false'){					PT.alert("请选择人员！");					return false;				}else if(ids!=null){					var flag=wg('flag');/*判断当前选择人员是否是单选：1单选、2多选*/					if(flag==1){						if(ids.length>1){							PT.alert('只能选择一个人员');							return;						}else{							users+=ids[0]+","+names[0];						}					}else{						for(var i=0;i<ids.length;i++){							if(ids[i]!=null&&ids[i]!=""){								if(i==ids.length-1)									users+=ids[i]+","+names[i];								else									users+=ids[i]+","+names[i]+";";												}											}					}				}				PT.closeModal(users);           ]]></bind>		<bind element="closeit" event="click"><![CDATA[				PT.closeModal('false');			]]>		</bind>	</form></Forms>